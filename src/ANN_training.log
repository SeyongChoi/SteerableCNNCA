2025-06-24 21:21:26 | ======================================================================================================
2025-06-24 21:21:26 | |                         Conditions of Training the Model for predicting CA                         |
2025-06-24 21:21:26 | ======================================================================================================
2025-06-24 21:21:26 | |                                          dataset settings                                          |
2025-06-24 21:21:26 | ------------------------------------------------------------------------------------------------------
2025-06-24 21:21:26 | | data_root_dir        | D:\SteerableCNNCA\data\                                                      |
2025-06-24 21:21:26 | | normalize            |                                                                              |
2025-06-24 21:21:26 | |  → ca_int            | True                                                                         |
2025-06-24 21:21:26 | |  → height            | True                                                                         |
2025-06-24 21:21:26 | | grid_size            | 100                                                                          |
2025-06-24 21:21:26 | | pbc_step             | 15                                                                           |
2025-06-24 21:21:26 | | split                | [0.7, 0.1, 0.2]                                                              |
2025-06-24 21:21:26 | ------------------------------------------------------------------------------------------------------
2025-06-24 21:21:26 | |                                           model settings                                           |
2025-06-24 21:21:26 | ------------------------------------------------------------------------------------------------------
2025-06-24 21:21:26 | | type                 | ANN                                                                          |
2025-06-24 21:21:26 | | conv_channels        | [10, 10, 10]                                                                 |
2025-06-24 21:21:26 | | conv_dropout_rates   | [0.2, 0.2, 0.2]                                                              |
2025-06-24 21:21:26 | | conv_kernel          | 4                                                                            |
2025-06-24 21:21:26 | | conv_stride          | 1                                                                            |
2025-06-24 21:21:26 | | pool_kernel          | 2                                                                            |
2025-06-24 21:21:26 | | pool_stride          | 2                                                                            |
2025-06-24 21:21:26 | | hidden_dims          | [1000, 100]                                                                  |
2025-06-24 21:21:26 | | dropout_rates        | [0.2, 0.2]                                                                   |
2025-06-24 21:21:26 | | weight_init          | he_normal                                                                    |
2025-06-24 21:21:26 | ------------------------------------------------------------------------------------------------------
2025-06-24 21:21:26 | |                                         training settings                                          |
2025-06-24 21:21:26 | ------------------------------------------------------------------------------------------------------
2025-06-24 21:21:26 | | device               | cpu                                                                          |
2025-06-24 21:21:26 | | batch_size           | 32                                                                           |
2025-06-24 21:21:26 | | max_epochs           | 10                                                                           |
2025-06-24 21:21:26 | | lr                   | 0.001                                                                        |
2025-06-24 21:21:26 | | loss_fn              | mse                                                                          |
2025-06-24 21:21:26 | | optimizer            | adam                                                                         |
2025-06-24 21:21:26 | | l2_reg               | 0.1                                                                          |
2025-06-24 21:21:26 | ------------------------------------------------------------------------------------------------------
2025-06-24 21:21:26 | |                                          logging settings                                          |
2025-06-24 21:21:26 | ------------------------------------------------------------------------------------------------------
2025-06-24 21:21:26 | | wandb                |                                                                              |
2025-06-24 21:21:26 | |  → enable            | True                                                                         |
2025-06-24 21:21:26 | |  → project_name      | SteerableCNNCA                                                               |
2025-06-24 21:21:26 | |  → run_name          | run_1                                                                        |
2025-06-24 21:21:26 | | TensorBoard          |                                                                              |
2025-06-24 21:21:26 | |  → enable            | True                                                                         |
2025-06-24 21:21:26 | |  → log_dir           | logs                                                                         |
2025-06-24 21:21:26 | ------------------------------------------------------------------------------------------------------
2025-06-24 21:21:26 | 

2025-06-24 21:21:26 | ======================================================================================================
2025-06-24 21:21:26 | Load the dataset and transform it for the model type: ANN
2025-06-24 21:21:26 | ======================================================================================================
2025-06-24 21:21:26 |    width  pitch  height  ca_int_deg shape  ca_exp_deg  ca_wz_deg   ca_cb_deg  norm_height  norm_ca_int
0   8.09   8.09    30.8        62.0   rec       159.0        0.0  129.244583     0.109157          0.0
1  14.71  16.18    31.7        62.0   rec       157.0        0.0  131.817868     0.112348          0.0
2  30.88  32.35    33.0        62.0   rec       157.0        0.0  130.505047     0.116959          0.0
3  20.59  20.59    30.7        62.0   rec       157.0        0.0  129.244583     0.108802          0.0
4  20.59  25.00    30.5        62.0   rec       157.0        0.0  134.448422     0.108093          0.0
2025-06-24 21:21:26 | (280, 10)
2025-06-24 21:21:29 | Number of inputs:  5320
2025-06-24 21:21:29 | Number of outputs: 5320
2025-06-24 21:21:29 | [input]  Train size: 3723, Val size: 532, Test size: 1065
2025-06-24 21:21:29 | [output] Train size: 3723, Val size: 532, Test size: 1065
2025-06-24 21:21:29 | ------------------------------------------------------------------------------------------------------
2025-06-24 21:21:29 | Creating dataset for ANN model...
2025-06-24 21:21:29 | ------------------------------------------------------------------------------------------------------
2025-06-24 21:21:29 | Train dataset size: 3723
2025-06-24 21:21:29 | Validation dataset size: 532
2025-06-24 21:21:29 | Test dataset size: 1065
2025-06-24 21:21:29 | ------------------------------------------------------------------------------------------------------
2025-06-24 21:21:29 | Creating DataLoader...
2025-06-24 21:21:29 | ------------------------------------------------------------------------------------------------------
2025-06-24 21:21:29 | Train DataLoader size: 117
2025-06-24 21:21:29 | Validation DataLoader size: 17
2025-06-24 21:21:29 | Test DataLoader size: 34
2025-06-24 21:21:29 | ======================================================================================================
2025-06-24 21:21:29 | |                              Training the ANN model for predicting CA                              |
2025-06-24 21:21:29 | ======================================================================================================
2025-06-24 21:21:29 | ------------------------------------------------------------------------------------------------------
2025-06-24 21:21:29 | Initializing the ANN model...
2025-06-24 21:21:29 | ------------------------------------------------------------------------------------------------------
2025-06-24 21:21:29 | Input dimension for ANN model: 10002
2025-06-24 21:21:29 | 
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
ANNModel                                 [1]                       --
├─Sequential: 1-1                        [1]                       --
│    └─Linear: 2-1                       [1000]                    10,003,000
│    └─ReLU: 2-2                         [1000]                    --
│    └─Dropout: 2-3                      [1000]                    --
│    └─Linear: 2-4                       [100]                     100,100
│    └─ReLU: 2-5                         [100]                     --
│    └─Dropout: 2-6                      [100]                     --
│    └─Linear: 2-7                       [1]                       101
==========================================================================================
Total params: 10,103,201
Trainable params: 10,103,201
Non-trainable params: 0
Total mult-adds (G): 10.01
==========================================================================================
Input size (MB): 0.04
Forward/backward pass size (MB): 0.01
Params size (MB): 40.41
Estimated Total Size (MB): 40.46
==========================================================================================

2025-06-24 21:21:29 | ------------------------------------------------------------------------------------------------------
2025-06-24 21:21:29 | Setting up the Lightning Trainer & Logger...
2025-06-24 21:21:29 | ------------------------------------------------------------------------------------------------------
2025-06-24 21:21:29 | Using WandB logger - project: SteerableCNNCA, run: run_1
2025-06-24 21:21:29 | Using TensorBoard logger - log dir: logs
2025-06-24 21:21:29 | GPU available: False, used: False
2025-06-24 21:21:29 | TPU available: False, using: 0 TPU cores
2025-06-24 21:21:29 | HPU available: False, using: 0 HPUs
2025-06-24 21:21:29 | 
  | Name      | Type       | Params | Mode 
-------------------------------------------------
0 | model     | Sequential | 10.1 M | train
1 | criterion | MSELoss    | 0      | train
-------------------------------------------------
10.1 M    Trainable params
0         Non-trainable params
10.1 M    Total params
40.413    Total estimated model params size (MB)
9         Modules in train mode
0         Modules in eval mode
2025-06-24 21:21:54 | `Trainer.fit` stopped: `max_epochs=10` reached.
2025-06-24 21:21:54 | Best model path: D:\SteerableCNNCA\src\checkpoints\ANN-epoch=09-val_loss=531.4950-v3.ckpt
2025-06-24 21:21:55 | Test results: [{'test_loss': 588.2882690429688}]
