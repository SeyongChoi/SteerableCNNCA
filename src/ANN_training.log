2025-06-23 17:54:52 | ======================================================================================================
2025-06-23 17:54:52 | |                         Conditions of Training the Model for predicting CA                         |
2025-06-23 17:54:52 | ======================================================================================================
2025-06-23 17:54:52 | |                                          dataset settings                                          |
2025-06-23 17:54:52 | ------------------------------------------------------------------------------------------------------
2025-06-23 17:54:52 | |    data_root_dir    | D:\SteerableCNNCA\data\                                                      |
2025-06-23 17:54:52 | |      normalize      | {'ca_int': True, 'height': True}                                             |
2025-06-23 17:54:52 | |      grid_size      | 100                                                                          |
2025-06-23 17:54:52 | |      pbc_step       | 15                                                                           |
2025-06-23 17:54:52 | |        split        | [0.7, 0.1, 0.2]                                                              |
2025-06-23 17:54:52 | ------------------------------------------------------------------------------------------------------
2025-06-23 17:54:52 | |                                           model settings                                           |
2025-06-23 17:54:52 | ------------------------------------------------------------------------------------------------------
2025-06-23 17:54:52 | |        type         | ANN                                                                          |
2025-06-23 17:54:52 | |     hidden_dims     | [1000, 100]                                                                  |
2025-06-23 17:54:52 | |    dropout_rates    | [0.2, 0.2]                                                                   |
2025-06-23 17:54:52 | |     weight_init     | he_normal                                                                    |
2025-06-23 17:54:52 | ------------------------------------------------------------------------------------------------------
2025-06-23 17:54:52 | |                                         training settings                                          |
2025-06-23 17:54:52 | ------------------------------------------------------------------------------------------------------
2025-06-23 17:54:52 | |       device        | cpu                                                                          |
2025-06-23 17:54:52 | |     batch_size      | 32                                                                           |
2025-06-23 17:54:52 | |     max_epochs      | 10                                                                           |
2025-06-23 17:54:52 | |         lr          | 0.001                                                                        |
2025-06-23 17:54:52 | |       loss_fn       | mse                                                                          |
2025-06-23 17:54:52 | |      optimizer      | adam                                                                         |
2025-06-23 17:54:52 | |       l2_reg        | 0.1                                                                          |
2025-06-23 17:54:52 | ------------------------------------------------------------------------------------------------------
2025-06-23 17:54:52 | |                                          logging settings                                          |
2025-06-23 17:54:52 | ------------------------------------------------------------------------------------------------------
2025-06-23 17:54:52 | |        wandb        | {'enable': True, 'project_name': 'SteerableCNNCA', 'entity': 'your_wandb_entity', 'run_name': 'run_1'} |
2025-06-23 17:54:52 | ------------------------------------------------------------------------------------------------------
2025-06-23 17:54:52 | 

2025-06-23 17:54:52 | ======================================================================================================
2025-06-23 17:54:52 | Load the dataset and transform it for the model type: ANN
2025-06-23 17:54:52 | ======================================================================================================
2025-06-23 17:54:52 |    width  pitch  height  ca_int_deg shape  ca_exp_deg  ca_wz_deg   ca_cb_deg  norm_height  norm_ca_int
0   8.09   8.09    30.8        62.0   rec       159.0        0.0  129.244583     0.109157          0.0
1  14.71  16.18    31.7        62.0   rec       157.0        0.0  131.817868     0.112348          0.0
2  30.88  32.35    33.0        62.0   rec       157.0        0.0  130.505047     0.116959          0.0
3  20.59  20.59    30.7        62.0   rec       157.0        0.0  129.244583     0.108802          0.0
4  20.59  25.00    30.5        62.0   rec       157.0        0.0  134.448422     0.108093          0.0
2025-06-23 17:54:52 | (280, 10)
2025-06-23 17:54:55 | Number of inputs:  5320
2025-06-23 17:54:55 | Number of outputs: 5320
2025-06-23 17:54:55 | [input]  Train size: 3723, Val size: 532, Test size: 1065
2025-06-23 17:54:55 | [output] Train size: 3723, Val size: 532, Test size: 1065
2025-06-23 17:54:55 | ------------------------------------------------------------------------------------------------------
2025-06-23 17:54:55 | Creating dataset for ANN model...
2025-06-23 17:54:55 | ------------------------------------------------------------------------------------------------------
2025-06-23 17:54:55 | Train dataset size: 3723
2025-06-23 17:54:55 | Validation dataset size: 532
2025-06-23 17:54:55 | Test dataset size: 1065
2025-06-23 17:54:55 | ------------------------------------------------------------------------------------------------------
2025-06-23 17:54:55 | Creating DataLoader...
2025-06-23 17:54:55 | ------------------------------------------------------------------------------------------------------
2025-06-23 17:54:55 | Train DataLoader size: 117
2025-06-23 17:54:55 | Validation DataLoader size: 17
2025-06-23 17:54:55 | Test DataLoader size: 34
2025-06-23 17:54:55 | ======================================================================================================
2025-06-23 17:54:55 | |                              Training the ANN model for predicting CA                              |
2025-06-23 17:54:55 | ======================================================================================================
2025-06-23 17:54:55 | ------------------------------------------------------------------------------------------------------
2025-06-23 17:54:55 | Initializing the ANN model...
2025-06-23 17:54:55 | ------------------------------------------------------------------------------------------------------
2025-06-23 17:54:55 | Input dimension for ANN model: 10002
2025-06-23 17:54:55 | 
----------------------------------------------------------------
        Layer (type)               Output Shape         Param #
================================================================
            Linear-1                 [-1, 1000]      10,003,000
              ReLU-2                 [-1, 1000]               0
           Dropout-3                 [-1, 1000]               0
            Linear-4                  [-1, 100]         100,100
              ReLU-5                  [-1, 100]               0
           Dropout-6                  [-1, 100]               0
            Linear-7                    [-1, 1]             101
================================================================
Total params: 10,103,201
Trainable params: 10,103,201
Non-trainable params: 0
----------------------------------------------------------------
Input size (MB): 0.04
Forward/backward pass size (MB): 0.03
Params size (MB): 38.54
Estimated Total Size (MB): 38.60
----------------------------------------------------------------

2025-06-23 17:54:55 | ------------------------------------------------------------------------------------------------------
2025-06-23 17:54:55 | Setting up the Lightning Trainer & Logger...
2025-06-23 17:54:55 | ------------------------------------------------------------------------------------------------------
2025-06-23 17:54:55 | GPU available: False, used: False
2025-06-23 17:54:55 | TPU available: False, using: 0 TPU cores
2025-06-23 17:54:55 | HPU available: False, using: 0 HPUs
2025-06-23 17:54:55 | 
  | Name      | Type       | Params | Mode 
-------------------------------------------------
0 | model     | Sequential | 10.1 M | train
1 | criterion | MSELoss    | 0      | train
-------------------------------------------------
10.1 M    Trainable params
0         Non-trainable params
10.1 M    Total params
40.413    Total estimated model params size (MB)
9         Modules in train mode
0         Modules in eval mode
2025-06-23 17:55:19 | `Trainer.fit` stopped: `max_epochs=10` reached.
2025-06-23 17:55:19 | Best model path: D:\SteerableCNNCA\src\checkpoints\ANN-epoch=09-val_loss=550.7734-v2.ckpt
2025-06-23 17:55:20 | Test results: [{'test_loss': 690.72412109375}]
