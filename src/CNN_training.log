2025-06-24 22:00:07 | ======================================================================================================
2025-06-24 22:00:07 | |                         Conditions of Training the Model for predicting CA                         |
2025-06-24 22:00:07 | ======================================================================================================
2025-06-24 22:00:07 | |                                          dataset settings                                          |
2025-06-24 22:00:07 | ------------------------------------------------------------------------------------------------------
2025-06-24 22:00:07 | | data_root_dir        | D:\SteerableCNNCA\data\                                                      |
2025-06-24 22:00:07 | | normalize            |                                                                              |
2025-06-24 22:00:07 | |  → ca_int            | True                                                                         |
2025-06-24 22:00:07 | |  → height            | True                                                                         |
2025-06-24 22:00:07 | | grid_size            | 100                                                                          |
2025-06-24 22:00:07 | | pbc_step             | 15                                                                           |
2025-06-24 22:00:07 | | split                | [0.7, 0.1, 0.2]                                                              |
2025-06-24 22:00:07 | ------------------------------------------------------------------------------------------------------
2025-06-24 22:00:07 | |                                           model settings                                           |
2025-06-24 22:00:07 | ------------------------------------------------------------------------------------------------------
2025-06-24 22:00:07 | | type                 | CNN                                                                          |
2025-06-24 22:00:07 | | conv_channels        | [10, 10, 10, 10, 10]                                                         |
2025-06-24 22:00:07 | | conv_dropout_rates   | [0.1, 0.1, 0.1, 0.1, 0.1]                                                    |
2025-06-24 22:00:07 | | conv_kernel          | 4                                                                            |
2025-06-24 22:00:07 | | conv_stride          | 1                                                                            |
2025-06-24 22:00:07 | | pool_kernel          | 2                                                                            |
2025-06-24 22:00:07 | | pool_stride          | 2                                                                            |
2025-06-24 22:00:07 | | hidden_dims          | [1000, 100]                                                                  |
2025-06-24 22:00:07 | | dropout_rates        | [0.1, 0.1]                                                                   |
2025-06-24 22:00:07 | | weight_init          | he_normal                                                                    |
2025-06-24 22:00:07 | ------------------------------------------------------------------------------------------------------
2025-06-24 22:00:07 | |                                         training settings                                          |
2025-06-24 22:00:07 | ------------------------------------------------------------------------------------------------------
2025-06-24 22:00:07 | | device               | cpu                                                                          |
2025-06-24 22:00:07 | | batch_size           | 32                                                                           |
2025-06-24 22:00:07 | | max_epochs           | 10                                                                           |
2025-06-24 22:00:07 | | lr                   | 0.001                                                                        |
2025-06-24 22:00:07 | | loss_fn              | mse                                                                          |
2025-06-24 22:00:07 | | optimizer            | adam                                                                         |
2025-06-24 22:00:07 | | l2_reg               | 0.001                                                                        |
2025-06-24 22:00:07 | ------------------------------------------------------------------------------------------------------
2025-06-24 22:00:07 | |                                          logging settings                                          |
2025-06-24 22:00:07 | ------------------------------------------------------------------------------------------------------
2025-06-24 22:00:07 | | wandb                |                                                                              |
2025-06-24 22:00:07 | |  → enable            | True                                                                         |
2025-06-24 22:00:07 | |  → project_name      | SteerableCNNCA                                                               |
2025-06-24 22:00:07 | |  → run_name          | run_1                                                                        |
2025-06-24 22:00:07 | | TensorBoard          |                                                                              |
2025-06-24 22:00:07 | |  → enable            | True                                                                         |
2025-06-24 22:00:07 | |  → log_dir           | logs                                                                         |
2025-06-24 22:00:07 | ------------------------------------------------------------------------------------------------------
2025-06-24 22:00:07 | 

2025-06-24 22:00:07 | ======================================================================================================
2025-06-24 22:00:07 | Load the dataset and transform it for the model type: CNN
2025-06-24 22:00:07 | ======================================================================================================
2025-06-24 22:00:07 |    width  pitch  height  ca_int_deg shape  ca_exp_deg  ca_wz_deg   ca_cb_deg  norm_height  norm_ca_int
0   8.09   8.09    30.8        62.0   rec       159.0        0.0  129.244583     0.109157          0.0
1  14.71  16.18    31.7        62.0   rec       157.0        0.0  131.817868     0.112348          0.0
2  30.88  32.35    33.0        62.0   rec       157.0        0.0  130.505047     0.116959          0.0
3  20.59  20.59    30.7        62.0   rec       157.0        0.0  129.244583     0.108802          0.0
4  20.59  25.00    30.5        62.0   rec       157.0        0.0  134.448422     0.108093          0.0
2025-06-24 22:00:07 | (280, 10)
2025-06-24 22:00:10 | Number of inputs:  5320
2025-06-24 22:00:10 | Number of outputs: 5320
2025-06-24 22:00:10 | [input]  Train size: 3723, Val size: 532, Test size: 1065
2025-06-24 22:00:10 | [output] Train size: 3723, Val size: 532, Test size: 1065
2025-06-24 22:00:10 | ------------------------------------------------------------------------------------------------------
2025-06-24 22:00:10 | Creating dataset for CNN model...
2025-06-24 22:00:10 | ------------------------------------------------------------------------------------------------------
2025-06-24 22:00:10 | Train dataset size: 3723
2025-06-24 22:00:10 | Validation dataset size: 532
2025-06-24 22:00:10 | Test dataset size: 1065
2025-06-24 22:00:10 | ------------------------------------------------------------------------------------------------------
2025-06-24 22:00:10 | Creating DataLoader...
2025-06-24 22:00:10 | ------------------------------------------------------------------------------------------------------
2025-06-24 22:00:10 | Train DataLoader size: 117
2025-06-24 22:00:10 | Validation DataLoader size: 17
2025-06-24 22:00:10 | Test DataLoader size: 34
2025-06-24 22:00:10 | ======================================================================================================
2025-06-24 22:00:10 | |                              Training the CNN model for predicting CA                              |
2025-06-24 22:00:10 | ======================================================================================================
2025-06-24 22:00:10 | ------------------------------------------------------------------------------------------------------
2025-06-24 22:00:10 | Initializing the CNN model...
2025-06-24 22:00:10 | ------------------------------------------------------------------------------------------------------
2025-06-24 22:00:10 | Input channel for CNN model: 1
2025-06-24 22:00:10 | ca_int_dim for CNN model: 1
2025-06-24 22:00:10 | dL_dim for CNN model: 1
2025-06-24 22:00:10 | 
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
CNNModel                                 [32, 1]                   --
├─ModuleList: 1-1                        --                        --
│    └─Sequential: 2-1                   [32, 10, 50, 50]          --
│    │    └─Conv2d: 3-1                  [32, 10, 100, 100]        170
│    │    └─ReLU: 3-2                    [32, 10, 100, 100]        --
│    │    └─MaxPool2d: 3-3               [32, 10, 50, 50]          --
│    │    └─Dropout: 3-4                 [32, 10, 50, 50]          --
│    └─Sequential: 2-2                   [32, 10, 25, 25]          --
│    │    └─Conv2d: 3-5                  [32, 10, 50, 50]          1,610
│    │    └─ReLU: 3-6                    [32, 10, 50, 50]          --
│    │    └─MaxPool2d: 3-7               [32, 10, 25, 25]          --
│    │    └─Dropout: 3-8                 [32, 10, 25, 25]          --
│    └─Sequential: 2-3                   [32, 10, 12, 12]          --
│    │    └─Conv2d: 3-9                  [32, 10, 25, 25]          1,610
│    │    └─ReLU: 3-10                   [32, 10, 25, 25]          --
│    │    └─MaxPool2d: 3-11              [32, 10, 12, 12]          --
│    │    └─Dropout: 3-12                [32, 10, 12, 12]          --
│    └─Sequential: 2-4                   [32, 10, 6, 6]            --
│    │    └─Conv2d: 3-13                 [32, 10, 12, 12]          1,610
│    │    └─ReLU: 3-14                   [32, 10, 12, 12]          --
│    │    └─MaxPool2d: 3-15              [32, 10, 6, 6]            --
│    │    └─Dropout: 3-16                [32, 10, 6, 6]            --
│    └─Sequential: 2-5                   [32, 10, 3, 3]            --
│    │    └─Conv2d: 3-17                 [32, 10, 6, 6]            1,610
│    │    └─ReLU: 3-18                   [32, 10, 6, 6]            --
│    │    └─MaxPool2d: 3-19              [32, 10, 3, 3]            --
│    │    └─Dropout: 3-20                [32, 10, 3, 3]            --
├─Sequential: 1-2                        [32, 100]                 --
│    └─Linear: 2-6                       [32, 1000]                93,000
│    └─ReLU: 2-7                         [32, 1000]                --
│    └─Dropout: 2-8                      [32, 1000]                --
│    └─Linear: 2-9                       [32, 100]                 100,100
│    └─ReLU: 2-10                        [32, 100]                 --
│    └─Dropout: 2-11                     [32, 100]                 --
├─Linear: 1-3                            [32, 1]                   101
==========================================================================================
Total params: 199,811
Trainable params: 199,811
Non-trainable params: 0
Total mult-adds (M): 230.86
==========================================================================================
Input size (MB): 1.28
Forward/backward pass size (MB): 34.34
Params size (MB): 0.80
Estimated Total Size (MB): 36.42
==========================================================================================

2025-06-24 22:00:10 | ------------------------------------------------------------------------------------------------------
2025-06-24 22:00:10 | Setting up the Lightning Trainer & Logger...
2025-06-24 22:00:10 | ------------------------------------------------------------------------------------------------------
2025-06-24 22:00:10 | Using WandB logger - project: SteerableCNNCA, run: run_1
2025-06-24 22:00:10 | Using TensorBoard logger - log dir: logs
2025-06-24 22:00:10 | GPU available: False, used: False
2025-06-24 22:00:10 | TPU available: False, using: 0 TPU cores
2025-06-24 22:00:10 | HPU available: False, using: 0 HPUs
2025-06-24 22:00:11 | 
  | Name        | Type       | Params | Mode 
---------------------------------------------------
0 | conv_blocks | ModuleList | 6.6 K  | train
1 | fcs         | Sequential | 193 K  | train
2 | out         | Linear     | 101    | train
3 | criterion   | MSELoss    | 0      | train
---------------------------------------------------
199 K     Trainable params
0         Non-trainable params
199 K     Total params
0.799     Total estimated model params size (MB)
35        Modules in train mode
0         Modules in eval mode
2025-06-24 22:00:39 | `Trainer.fit` stopped: `max_epochs=10` reached.
2025-06-24 22:00:39 | Best model path: D:\SteerableCNNCA\src\checkpoints\CNN-epoch=05-val_loss=822.2825.ckpt
2025-06-24 22:00:40 | Test results: [{'test_loss': 892.374267578125}]
